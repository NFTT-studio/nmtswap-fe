(this["webpackJsonpnmtswap-fe"]=this["webpackJsonpnmtswap-fe"]||[]).push([[0],{121:function(e,t,a){},124:function(e,t){},146:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(20),c=a.n(s),i=(a(121),a(14)),o=a(3),l=a.n(o),u=a(24),h=a(5),p=a(6),d=a(9),x=a(8),b=a(99),f=a(86),j=a.n(f),v=a(35),m="0xb5d65ff6ee3a366adafac882b2737a37dc73b66a",w="0xd81b71cBb89B2800CDb000AA277Dc1491dc923C3",O=function e(t){var a=this;Object(h.a)(this,e),this.isNMTAllowanceEnough=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r,s,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=["function allowance(address owner, address spender) external view returns (uint256)"],s=new v.a.Contract(w,r,a.provider),e.next=4,s.allowance(t,m);case 4:return c=e.sent,e.abrupt("return",parseInt(v.a.utils.formatEther(c))>parseInt(n));case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.isNMTBalanceEnough=function(){var e=Object(u.a)(l.a.mark((function e(t,n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.NMTBalance(t);case 2:return e.t0=e.sent,e.t1=parseInt(n),e.abrupt("return",e.t0>=e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.NMTBalance=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=["function balanceOf(address) view returns (uint)"],r=new v.a.Contract(w,n,a.provider),e.next=4,r.balanceOf(t);case 4:return s=e.sent,e.abrupt("return",parseInt(v.a.utils.formatEther(s)));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.NMTapproveAll=Object(u.a)(l.a.mark((function e(){var t,n,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["function approve(address spender, uint256 amount) external returns (bool)"],n=new v.a.Contract(w,t,a.provider),r=a.provider.getSigner(),e.next=5,n.connect(r).approve(m,"10000000000000000000000000");case 5:return s=e.sent,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)}))),this.erc20toNative=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var r,s,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=["function erc20toNative(string memory nativeAddress,uint256 amount) public returns (bool)"],s=new v.a.Contract(m,r,a.provider),c=a.provider.getSigner(),e.next=5,s.connect(c).erc20toNative(t,v.a.utils.parseUnits(n).toString());case 5:return i=e.sent,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),this.provider=new v.a.providers.Web3Provider(t,"any")},g=a(178),k=a(180),_=a(183),C=a(184),T=a(195),S=a(76),A=a(193),M=a(185),y=a(186),N=a(187),I=a(188),B=a(198),F=a(189),D=a(190),E=a(191),P=a(192),R=a(11),U=a(194),z=a(197),q=a(12),W=r.a.forwardRef((function(e,t){return Object(q.jsx)(g.a,Object(b.a)({direction:"up",ref:t},e))})),G=function(e){Object(d.a)(a,e);var t=Object(x.a)(a);function a(){var e;return Object(h.a)(this,a),(e=t.call(this))._isMainChain=function(){return"0x1"===e.state.chainId},e.requestAccount=Object(u.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.provider.request({method:"eth_requestAccounts"});case 2:return a=t.sent,t.next=5,e.handleAccountsChanged(a);case 5:case"end":return t.stop()}}),t)}))),e._localSave=function(t,a){localStorage.setItem(e.state.currentAccount+"_"+t,a)},e._localGet=function(t){return localStorage.getItem(e.state.currentAccount+"_"+t)},e._localRemove=function(t){return localStorage.removeItem(e.state.currentAccount+"_"+t)},e.handleApprove=Object(u.a)(l.a.mark((function t(){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.contractUtil.NMTapproveAll();case 3:a=t.sent,e.setState({approveTx:a.hash,approveDialogOpen:!1}),e._localSave("approveTx",a.hash),e._checkApproveTx(),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(0),e.handleApproveDialogClose(),console.error(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,9]])}))),e.handleApproveDialogClose=function(){e.setState({approveDialogOpen:!1})},e._checkApproveTx=function(){null!==e.state.approveTx&&e.contractUtil.provider.waitForTransaction(e.state.approveTx,1).then((function(t){0===t.status&&e.setState({alertMessage:"Transaction Error, Please Check it"}),e.setState({approveTx:null,approveSuccess:!0}),e._localRemove("approveTx")}))},e._handleSwithChain=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.provider.request({method:"wallet_switchEthereumChain",params:[{chainId:"0x1"}]});case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.info(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])}))),e._handleConnectClick=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.provider){t.next=3;break}return e.setState({alertMessage:"Please Install MetaMask First"}),t.abrupt("return");case 3:if(e._isMainChain()){t.next=6;break}return e.setState({alertMessage:"Please Select Ethereum Main Network First"}),t.abrupt("return");case 6:e.requestAccount();case 7:case"end":return t.stop()}}),t)}))),e.handleChainChanged=function(e){window.location.reload()},e.handleAccountsChanged=function(){var t=Object(u.a)(l.a.mark((function t(a){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!a[0]){t.next=9;break}if(e.setState({currentAccount:a[0]}),!e._isMainChain()){t.next=7;break}return t.next=5,e.contractUtil.NMTBalance(e.state.currentAccount);case 5:n=t.sent,e.setState({nmtBalance:n});case 7:t.next=10;break;case 9:e.setState({currentAccount:""});case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleAmountChange=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({swapAmount:a.target.value});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleNativeChange=function(){var t=Object(u.a)(l.a.mark((function t(a){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.setState({targetNativeAddress:a.target.value});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e._checkSwapTx=function(){null!==e.state.swapTx&&e.contractUtil.provider.waitForTransaction(e.state.swapTx,1).then((function(t){0===t.status&&e.alertMessage("Transaction Error, Please Check it"),e.setState({swapTx:null,commitSuccess:!0,approveSuccess:!1}),e._localRemove("swapTx")}))},e.handleSwap=Object(u.a)(l.a.mark((function t(){var a,n,r,s;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._isMainChain()){t.next=3;break}return e.setState({alertMessage:"Please Select Ethereum Main Network First"}),t.abrupt("return");case 3:try{n=Object(U.a)(Object(z.a)(e.state.targetNativeAddress)),r=Object(i.a)(n,1),a=r[0]}catch(c){a=!1}if(a){t.next=7;break}return e.setState({alertMessage:"Please check you Native Address"}),t.abrupt("return");case 7:if(!(e.state.swapAmount>e.state.nmtBalance)){t.next=10;break}return e.setState({alertMessage:"Insufficient NMT balance"}),t.abrupt("return");case 10:return t.next=12,e.contractUtil.isNMTAllowanceEnough(e.state.currentAccount,e.state.swapAmount);case 12:if(t.sent){t.next=16;break}e.setState({approveDialogOpen:!0}),t.next=28;break;case 16:return t.prev=16,t.next=19,e.contractUtil.erc20toNative(e.state.targetNativeAddress,e.state.swapAmount);case 19:s=t.sent,e.setState({swapTx:s.hash,approveSuccess:!1}),e._localSave("swapTx",s.hash),e._checkSwapTx(),t.next=28;break;case 25:t.prev=25,t.t0=t.catch(16),console.error(t.t0);case 28:case"end":return t.stop()}}),t,null,[[16,25]])}))),e._handleClearApproveTx=function(){e._localRemove("approveTx"),e.setState({approveTx:null})},e._handleClearSwapTx=function(){e._localRemove("swapTx"),e.setState({swapTx:null})},e.state={currentAccount:"",targetNativeAddress:"",swapAmount:0,nmtBalance:0,alertMessage:"",approveDialogOpen:!1,chainId:"0x1",isInstallMetaMask:!0,approveTx:null,swapTx:null,commitSuccess:!1,approveSuccess:!1},e}return Object(p.a)(a,[{key:"componentDidMount",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j()();case 2:if(this.provider=e.sent,!this.provider){e.next=27;break}return this.contractUtil=new O(this.provider),this.provider.on("chainChanged",this.handleChainChanged),this.provider.on("accountsChanged",this.handleAccountsChanged),e.t0=this,e.next=10,this.provider.request({method:"eth_chainId"});case 10:return e.t1=e.sent,e.t2={chainId:e.t1},e.t0.setState.call(e.t0,e.t2),e.next=15,this.requestAccount();case 15:if(!this._isMainChain()){e.next=25;break}if(console.info(this.state.currentAccount),!this.state.currentAccount){e.next=25;break}return this.setState({approveTx:this._localGet("approveTx"),swapTx:this._localGet("swapTx")}),this._checkApproveTx(),this._checkSwapTx(),e.next=23,this.contractUtil.NMTBalance(this.state.currentAccount);case 23:t=e.sent,this.setState({nmtBalance:t});case 25:e.next=29;break;case 27:this.setState({isInstallMetaMask:!1}),console.log("Please install MetaMask!");case 29:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.classes;return Object(q.jsxs)(r.a.Fragment,{children:[Object(q.jsxs)(k.a,{maxWidth:"sm",className:t.root,children:[Object(q.jsx)(_.a,{className:t.card,variant:"outlined",children:Object(q.jsxs)(C.a,{container:!0,spacing:3,children:[!this.state.isInstallMetaMask&&Object(q.jsx)(C.a,{container:!0,className:t.style_flex_center,children:Object(q.jsx)("a",{href:"https://metamask.io/download.html",rel:"noreferrer",target:"_blank",style:{textDecoration:"none"},children:Object(q.jsx)(T.a,{variant:"contained",size:"large",color:"secondary",children:"Please click and install MetaMask!  https://metamask.io/download.html"})})}),!this._isMainChain()&&Object(q.jsx)(C.a,{container:!0,className:t.style_flex_center,children:Object(q.jsx)(T.a,{onClick:this._handleSwithChain,variant:"contained",size:"large",color:"secondary",children:"Click And Switch Ethereum Main Network"})}),Object(q.jsx)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:Object(q.jsx)(S.a,{variant:"h5",style:{paddingBottom:"20px"},children:"NMT ERC20 to Native"})}),Object(q.jsx)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:""!==this.state.currentAccount?Object(q.jsx)(A.a,{disabled:!0,fullWidth:!0,id:"outlined-basic",label:"From ERC20 Address",variant:"outlined",value:this.state.currentAccount}):Object(q.jsx)(T.a,{variant:"contained",color:"secondary",size:"large",onClick:this._handleConnectClick,children:"Connect Wallet"})}),Object(q.jsx)(C.a,{item:!0,xs:12,children:Object(q.jsx)(A.a,{disabled:""===this.state.currentAccount,id:"outlined-basic",fullWidth:!0,label:"To Native Address",variant:"outlined",onChange:this.handleNativeChange})}),Object(q.jsx)(C.a,{item:!0,xs:12,children:Object(q.jsx)(A.a,{disabled:""===this.state.currentAccount,id:"outlined-basic",fullWidth:!0,label:"Swap Amount",variant:"outlined",placeholder:this.state.nmtBalance.toString(),type:"number",onChange:this.handleAmountChange})}),Object(q.jsx)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:Object(q.jsx)(T.a,{variant:"contained",color:"secondary",onClick:this.handleSwap,disabled:""===this.state.currentAccount||this.state.swapAmount<1||""===this.state.targetNativeAddress,size:"large",children:"Swap"})}),Object(q.jsxs)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:[this.state.approveTx&&Object(q.jsxs)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:[Object(q.jsx)(M.a,{color:"inherit",size:20}),Object(q.jsx)("br",{}),Object(q.jsxs)(C.a,{children:["\xa0\xa0Tx:\xa0\xa0 ",Object(q.jsxs)("a",{target:"_blank",rel:"noreferrer",href:"https://etherscan.io/tx/"+this.state.approveTx,children:[this.state.approveTx.substring(0,15)+"..."," "]})]}),"\xa0",Object(q.jsx)(T.a,{size:"small",variant:"outlined",onClick:this._handleClearApproveTx,children:"clear"})]}),this.state.swapTx&&Object(q.jsxs)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:[Object(q.jsx)(M.a,{color:"inherit",size:20}),Object(q.jsx)("br",{}),Object(q.jsxs)(C.a,{children:["\xa0\xa0Tx:\xa0\xa0",Object(q.jsxs)("a",{rel:"noreferrer",href:"https://etherscan.io/tx/"+this.state.swapTx,target:"_blank",children:[" ",this.state.swapTx.substring(0,15)+"..."]})]}),"\xa0",Object(q.jsx)(T.a,{size:"small",variant:"outlined",onClick:this._handleClearSwapTx,children:"clear"})]}),this.state.commitSuccess&&Object(q.jsx)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:Object(q.jsx)(S.a,{variant:"h6",style:{color:"red"},children:" Commit Success "})}),this.state.approveSuccess&&Object(q.jsx)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:Object(q.jsx)(S.a,{variant:"h6",children:" Approve Success "})})]})]})}),Object(q.jsx)("br",{}),Object(q.jsxs)(_.a,{className:t.card,children:[Object(q.jsx)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:Object(q.jsx)(S.a,{variant:"h6",style:{margin:"15px"},children:" Contact us"})}),Object(q.jsxs)(C.a,{item:!0,xs:12,className:t.style_flex_center,children:[Object(q.jsx)("a",{rel:"noreferrer",href:"https://t.me/NFTmart",target:"_blank",children:"Telegram"}),"\xa0 \xa0\xa0\xa0",Object(q.jsx)("a",{rel:"noreferrer",href:"https://twitter.com/NFTmartio",target:"_blank",children:"Twitter"})]})]}),Object(q.jsx)(y.a,{position:"fixed",color:"default",style:{top:"auto",bottom:0},children:Object(q.jsx)(N.a,{children:Object(q.jsxs)(S.a,{variant:"subtitle2",noWrap:!0,style:{flexGrow:1,margin:"30px"},align:"center",children:["Power by ",Object(q.jsx)(I.a,{href:"https://www.nftmart.io",color:"inherit",target:"_blank",children:"NFTMart.io"}),"\xa0\xa0  ",Object(q.jsx)(I.a,{href:"https://etherscan.io/address/0xb5d65ff6ee3a366adafac882b2737a37dc73b66a#code",color:"inherit",target:"_blank",children:"NMTSwap Source Code"})]})})})]}),Object(q.jsxs)(B.a,{open:""!==this.state.alertMessage,onClose:function(){e.setState({alertMessage:""})},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(q.jsx)(F.a,{children:Object(q.jsx)(D.a,{id:"alert-dialog-description",children:this.state.alertMessage})}),Object(q.jsx)(E.a,{children:Object(q.jsx)(T.a,{onClick:function(){e.setState({alertMessage:""})},color:"primary",autoFocus:!0,children:"Ok"})})]}),Object(q.jsxs)(B.a,{open:this.state.approveDialogOpen,TransitionComponent:W,keepMounted:!0,onClose:this.handleApproveDialogClose,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(q.jsx)(P.a,{id:"alert-dialog-slide-title",children:"Approve Confirm"}),Object(q.jsx)(F.a,{children:Object(q.jsx)(D.a,{id:"alert-dialog-slide-description",children:"Please approve NMTSwap contract transfer NMT."})}),Object(q.jsxs)(E.a,{children:[Object(q.jsx)(T.a,{onClick:this.handleApproveDialogClose,color:"primary",children:"Reject"}),Object(q.jsx)(T.a,{onClick:this.handleApprove,color:"primary",children:"Confirm"})]})]})]})}}]),a}(r.a.Component),J=Object(R.a)((function(e){return{root:{marginTop:e.spacing(8)},card:{padding:e.spacing(4)},style_flex_center:{display:"flex",justifyContent:"center",alignItems:"center"}}}))(G),L=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,199)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;a(e),n(e),r(e),s(e),c(e)}))};c.a.render(Object(q.jsx)(r.a.StrictMode,{children:Object(q.jsx)(J,{})}),document.getElementById("root")),L()}},[[146,1,2]]]);
//# sourceMappingURL=main.aa80bb0f.chunk.js.map